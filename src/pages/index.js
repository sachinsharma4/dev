import Head from 'next/head'
import Image from 'next/image'
import { Inter } from '@next/font/google'
import styles from '@/styles/Home.module.css'
import Link from 'next/link'
import { BiMicrophone, BiSearch } from 'react-icons/bi';
import React, { useState} from 'react'
//import SpeechRecognition, { useSpeechRecognition } from 'react-speech-recognition';

const inter = Inter({ subsets: ['latin'] })






      export default function  Home(props){

      console.log(props)
      
        
  const [value,setvalue]=useState("");
      const [Fungi,setFungi]=useState(props.data);
      const [placeholder,setplaceholder]=useState("enter the name fungi");

    const record = ()=>{ setplaceholder("listening");
    var recognition = new webkitSpeechRecognition();
    recognition.lang = "en-US";
    recognition.onresult = function(event) {
      setvalue(event.results[0][0].transcript);}
    recognition.onerror = function(error) {
      console.log("recording fail because "+error)
      setvalue("Enter the name of fungi");}
      recognition.start();
    
    
};
    
       
         
 




      return (
      <>
        <Head>
          <title>Create Next App</title>
          <meta name="description" content="Generated by create next app" />
          <meta name="viewport" content="width=device-width, initial-scale=1" />
          <meta name="theme-color" content="rgb(216,180,254)" />
        </Head>
      
        <header className={`${styles.header} bg-cover text-white text-center flex-col justify-center h-80`}>
          <h1 className='pt-32'>KMCEDOF</h1>
          <span className=''>A Database of Fungi by Kirori Mal College</span>
          {/*created a search box todo implement image and voice search */}
          <form id="fungi-form" action={`https://dev-puce.vercel.app/fungi/${value}`} method="post" className='flex justify-center '>
            <input value={value} list="fungi" onChange={(e) => setvalue(e.target.value)} placeholder={placeholder} className='rounded-full w-full lg:w-3/4 p-2 ml-6  mb-1 text-black outline-none' required/><BiMicrophone onClick={record}  className='text-blue-900  -translate-x-20 my-3'/><button type="submit" form="fungi-form" ><BiSearch className='text-blue-900  -translate-x-16 my-3'/></button></form>
          <datalist id='fungi'>
            {
              Fungi.map((item) => {
                return (<option key={item.fungi} value={item.fungi} />)
              })
            }

          </datalist>
        </header>
        <main className='p-3 flex'>
          {
            Fungi.map((item) => {
              return (
                <div key={item.fungi} className='border-2   h-48 lg:h-52 rounded-xl w-5/12 lg:w-3/12 p-2 m-2'>
                  <Link href={"./fungi/" + item.fungi}> <Image src="/pleurotous/image_1.jpeg" alt={item.fungi}  width={200} height={160} className='  bg-purple-200' />
                    <span className='font-bold italic'>{item.fungi}</span>
                    <p className=' line-clamp-2 lg:line-clamp-3 italic'>
                      {item.fungi}
                    </p></Link>
                </div>)
            })
          }




        </main>
        <footer className=' bg-purple-500 text-center pt-4 text-white'>
KMCEDOF <br/>
<div className='-translate-x-7'>follow us on:</div> 
        </footer>
      </>
      )
}
export const getServerSideProps = async (context) => {
 let data=await fetch("https://dev-puce.vercel.app/api/getfungus")
 .then(
    data => { return data.json() })
  return {
    props: { data}, // will be passed to the page component as props
  }
}